using System.Text.RegularExpressions;

namespace AdventOfCode2023;

	internal class DayEight {
	const string _testSet = "RL\r\n\r\nAAA = (BBB, CCC)\r\nBBB = (DDD, EEE)\r\nCCC = (ZZZ, GGG)\r\nDDD = (DDD, DDD)\r\nEEE = (EEE, EEE)\r\nGGG = (GGG, GGG)\r\nZZZ = (ZZZ, ZZZ)";
	const string _dataSet = "LRLRLRLRRLRRRLRLRLRRRLLRRLRRLRRLLRRLRRLRLRRRLRRLLRRLRRRLRRLRRRLRRRLLLRRLLRLLRRRLLRRLRLLRLLRRRLLRRLRRLRRRLRRLRLRRLRRLRLLRLRRRLRLRRLRLLRRLRRRLRRLRLRRLLLRRLRRRLRRRLRRLRRRLRLRRLRRLRRRLRRLRRLRRLRRLRRRLLRRRLLLRRRLRRLRRRLLRRRLRRLRRLLLLLRRRLRLRRLRRLLRRLRRLRLRLRRRLRRRLRRLLLRRRR\r\n\r\nBPQ = (VXR, TLN)\r\nNSK = (FRM, GXV)\r\nXVG = (BBC, SGF)\r\nJTG = (LVR, MPK)\r\nRNQ = (TMP, TLT)\r\nVVX = (TVH, GCM)\r\nDJH = (MMH, LLQ)\r\nLQR = (HFF, FHP)\r\nQFQ = (CFT, STF)\r\nRJL = (TFG, CTR)\r\nDRB = (GBQ, NRB)\r\nKHK = (XDB, DVQ)\r\nNCG = (SHP, LTM)\r\nKSD = (KQT, PDB)\r\nMGL = (LDG, DCN)\r\nKFX = (HLG, VGF)\r\nKFG = (JGB, GVH)\r\nJLV = (CGX, MQN)\r\nCCB = (JXL, LHD)\r\nCSJ = (GQS, FHJ)\r\nVPX = (RGL, XMD)\r\nCHV = (DHP, DKG)\r\nLRV = (MLC, HQQ)\r\nBPJ = (QJP, VLR)\r\nVFF = (PSS, NFD)\r\nFCM = (JBG, NRK)\r\nGBQ = (JRQ, TLQ)\r\nVLM = (KRH, BMQ)\r\nGXS = (TKS, TQZ)\r\nNNM = (LDG, DCN)\r\nQVN = (TMP, TLT)\r\nJCR = (GLG, KFV)\r\nMFM = (MXN, PMM)\r\nGLG = (JSK, HHT)\r\nLGH = (RXD, NDN)\r\nCRH = (MCD, DSJ)\r\nFDD = (XTR, QSS)\r\nQQX = (XPS, XPS)\r\nXGF = (LPL, PMR)\r\nDFG = (FTR, JTK)\r\nHHV = (KHK, QDJ)\r\nLDX = (GBP, RFP)\r\nJJD = (SNC, CST)\r\nCGG = (VXR, TLN)\r\nVQB = (LBM, RBD)\r\nQRT = (DJH, BKC)\r\nKFP = (SVN, SCG)\r\nBKC = (LLQ, MMH)\r\nKJF = (BGB, CTL)\r\nVDL = (XFX, QGQ)\r\nJNN = (CSX, JQX)\r\nLDV = (TTQ, CQR)\r\nSJD = (QNM, NSK)\r\nRPD = (XFQ, SKS)\r\nBMR = (MRH, RSM)\r\nCNK = (QQK, DHQ)\r\nMLD = (MNC, BQT)\r\nPQS = (VLN, LJC)\r\nHKK = (RQP, VGD)\r\nQCS = (KVD, XPB)\r\nKVD = (QRT, TVP)\r\nJMK = (BLV, PQS)\r\nCJF = (KPD, GRJ)\r\nDTG = (TCX, LVM)\r\nDQG = (GQQ, CQK)\r\nVNN = (QNF, CDC)\r\nSHV = (LLV, QNQ)\r\nHQQ = (VNN, XPG)\r\nLVM = (LQH, NVM)\r\nVFP = (VPX, MRG)\r\nSBG = (PXL, LNC)\r\nPXL = (PCQ, RVK)\r\nCXH = (SBL, SKV)\r\nHTM = (PPF, RCT)\r\nGBP = (JMX, JMX)\r\nQMN = (BSJ, NBP)\r\nDDJ = (LRF, NHV)\r\nQMS = (GNT, DMH)\r\nQDG = (CSF, NSB)\r\nVGR = (QMS, BXX)\r\nMCB = (SSQ, KNF)\r\nJVL = (PCC, MQX)\r\nRCQ = (PQP, CMP)\r\nNQK = (KXG, DQR)\r\nCFT = (QHQ, XKH)\r\nCMP = (NPS, DXN)\r\nKKV = (BPJ, QBG)\r\nSGF = (CTP, KKQ)\r\nBKL = (RCR, NFS)\r\nJHN = (CGN, SHV)\r\nGLB = (HMC, NFQ)\r\nQTG = (FRF, LMN)\r\nNFS = (LQX, KCL)\r\nRNK = (QCB, BRJ)\r\nKLX = (VST, SVR)\r\nSMK = (JSJ, QTG)\r\nKQJ = (FNS, NPD)\r\nCQR = (JNC, BKP)\r\nMCP = (HLM, SLC)\r\nHMP = (QRN, BDN)\r\nDQJ = (CNK, GSR)\r\nXFD = (HMV, XPR)\r\nBDB = (PQS, BLV)\r\nBXG = (CHV, VVM)\r\nCGN = (QNQ, LLV)\r\nJDB = (FCS, FBX)\r\nXFC = (MJT, QML)\r\nPMR = (SJD, TGD)\r\nGVP = (SBS, KJF)\r\nXPS = (DQJ, DQJ)\r\nKCF = (HCT, DBS)\r\nKRH = (GDD, KLX)\r\nFDT = (LHD, JXL)\r\nVLH = (VJP, NCG)\r\nJNC = (HPT, VDQ)\r\nJMX = (MVJ, MVJ)\r\nRKN = (CJF, CJF)\r\nPFS = (LHB, FDD)\r\nQXG = (RLP, DXM)\r\nCTL = (JVX, MVN)\r\nCTP = (JNG, VFP)\r\nFBK = (DQL, KKX)\r\nXBH = (XQK, LMV)\r\nRXH = (DHM, DHM)\r\nXNN = (NPM, GJF)\r\nSKS = (XJP, MQL)\r\nRNC = (FKF, RGS)\r\nHNT = (NTV, RSG)\r\nRCR = (LQX, KCL)\r\nLMN = (PDT, QXG)\r\nDGK = (QQX, RCK)\r\nQGS = (GKL, PHD)\r\nJSJ = (LMN, FRF)\r\nJNG = (MRG, VPX)\r\nKHF = (MHR, RDM)\r\nMQX = (MKS, LRQ)\r\nBXN = (LMV, XQK)\r\nRCT = (DRK, QKJ)\r\nNGL = (MMQ, JNN)\r\nLXL = (RCH, TJF)\r\nMVN = (NLN, CCC)\r\nKGQ = (DML, VCT)\r\nSVN = (DBR, JJD)\r\nBKQ = (XKJ, JNM)\r\nLCA = (CNK, GSR)\r\nHHB = (HMK, HJP)\r\nNHB = (BVP, JBL)\r\nSXD = (SKC, RDJ)\r\nTCX = (LQH, NVM)\r\nCST = (QTC, KVK)\r\nQRN = (RPD, QQF)\r\nMXS = (DQG, NJC)\r\nDPN = (LRV, DGH)\r\nLJJ = (TSP, SKL)\r\nLRF = (XFD, CKQ)\r\nRSG = (QDL, GCD)\r\nJBC = (SLC, HLM)\r\nRVK = (RBM, JRP)\r\nXQG = (DGH, LRV)\r\nQDJ = (DVQ, XDB)\r\nSMT = (BHN, KTM)\r\nTPF = (SFV, BVD)\r\nLGS = (RSQ, JCR)\r\nDMB = (CRH, FQD)\r\nLVN = (QMS, BXX)\r\nMVJ = (TKS, TKS)\r\nVXR = (RBP, RCQ)\r\nCSX = (TNJ, DJG)\r\nTVH = (RXH, RXH)\r\nDXM = (LPF, LSS)\r\nHCT = (KFX, CMC)\r\nLHB = (QSS, XTR)\r\nXNQ = (DQJ, XCZ)\r\nNHK = (PDQ, FLN)\r\nDKT = (QCL, QCL)\r\nBVV = (JNN, MMQ)\r\nXHP = (DDJ, SQN)\r\nLMK = (LTK, MPV)\r\nNNH = (NKM, KGQ)\r\nCFG = (DPN, XQG)\r\nBLM = (CNQ, KJX)\r\nJKS = (MFX, VVF)\r\nDHM = (XVL, XVL)\r\nDRK = (LXL, PCH)\r\nTLC = (TPQ, FRJ)\r\nKPF = (SHL, NQH)\r\nCCQ = (JMK, BDB)\r\nLQK = (CGG, BPQ)\r\nSHL = (FQG, XLS)\r\nMJV = (PNF, PNF)\r\nTNJ = (KSD, DHX)\r\nQDL = (GJH, CMX)\r\nBVF = (HNT, CPM)\r\nKSB = (BPH, MXS)\r\nFFB = (SFV, BVD)\r\nPMM = (LSV, FCM)\r\nJRQ = (LDV, FRP)\r\nVMH = (BPJ, QBG)\r\nKPD = (KBG, PFQ)\r\nGRT = (KKX, DQL)\r\nNJF = (DCG, MNK)\r\nHMC = (VVX, VCD)\r\nNTV = (QDL, GCD)\r\nGVH = (LRR, HRC)\r\nNCL = (LVN, VGR)\r\nJRV = (QBQ, HJF)\r\nFRF = (PDT, QXG)\r\nNXP = (CGN, SHV)\r\nJPR = (GBQ, NRB)\r\nRFP = (JMX, VSH)\r\nQCB = (GBT, BHR)\r\nMBT = (NPD, FNS)\r\nDTH = (VGR, LVN)\r\nGRJ = (KBG, PFQ)\r\nNPS = (FVB, FHL)\r\nVVM = (DKG, DHP)\r\nTRT = (KKV, VMH)\r\nJSP = (NRT, NKC)\r\nVLR = (RJL, NQR)\r\nPPZ = (QKG, HCB)\r\nVHV = (DRC, KMB)\r\nBGG = (DDJ, SQN)\r\nCSF = (MLD, BTC)\r\nQQF = (XFQ, SKS)\r\nFTM = (CNQ, KJX)\r\nKKJ = (RPC, RRK)\r\nQTV = (HFN, FXJ)\r\nRRL = (JDH, TMT)\r\nLTT = (HHV, KTD)\r\nTBP = (SNF, RMH)\r\nMCD = (FMM, DFG)\r\nPQQ = (XFC, DSS)\r\nHMV = (PHH, MXL)\r\nQCL = (LCN, LCN)\r\nMVX = (SSQ, KNF)\r\nDXN = (FVB, FHL)\r\nSKR = (RCR, NFS)\r\nBVP = (BMR, JVJ)\r\nNBP = (LTT, DBK)\r\nHPT = (JKS, GNS)\r\nLPL = (SJD, TGD)\r\nRSQ = (GLG, KFV)\r\nNBQ = (BPL, HGH)\r\nPQP = (NPS, DXN)\r\nLSS = (NHB, XVP)\r\nCKL = (MCB, MVX)\r\nLQX = (TPF, FFB)\r\nTGD = (NSK, QNM)\r\nFRP = (TTQ, CQR)\r\nRCH = (CCB, FDT)\r\nVVL = (RDJ, SKC)\r\nNVA = (KPD, GRJ)\r\nFMM = (FTR, JTK)\r\nKPM = (MQX, PCC)\r\nQXQ = (QDT, JLV)\r\nJVJ = (MRH, RSM)\r\nSMN = (HPX, CDM)\r\nXTP = (LLD, QBC)\r\nBVB = (JCR, RSQ)\r\nJTN = (TND, JFQ)\r\nCLK = (QXB, BGQ)\r\nNMX = (FTM, BLM)\r\nQKH = (BHN, KTM)\r\nVJP = (SHP, LTM)\r\nFNS = (SNX, GPP)\r\nDGH = (MLC, HQQ)\r\nNFM = (CVD, CTD)\r\nNKM = (DML, VCT)\r\nHMK = (FDX, SMK)\r\nVVQ = (FDD, LHB)\r\nFDX = (QTG, JSJ)\r\nMKL = (TDX, DLC)\r\nHQX = (GHS, LTX)\r\nKJX = (MQB, CTV)\r\nPHD = (NHK, PGQ)\r\nKDF = (TDD, PJM)\r\nMTK = (LCN, ZZZ)\r\nNVM = (LCC, MKL)\r\nXSH = (MJV, FRD)\r\nLLQ = (GRS, CFG)\r\nTGP = (XCK, MNR)\r\nXVJ = (VLH, TTX)\r\nPLR = (VVL, SXD)\r\nCTR = (DHV, VFQ)\r\nKKQ = (VFP, JNG)\r\nBMQ = (GDD, KLX)\r\nVVF = (LCV, MGX)\r\nPGQ = (FLN, PDQ)\r\nSSC = (MRN, JTG)\r\nTDD = (HTB, TBP)\r\nQKJ = (PCH, LXL)\r\nGXV = (BXN, XBH)\r\nMRG = (RGL, XMD)\r\nKXJ = (NXP, JHN)\r\nNFD = (NJF, BQP)\r\nGSS = (HPP, HQX)\r\nXDC = (JFC, JFC)\r\nPNF = (MGL, NNM)\r\nSQN = (LRF, NHV)\r\nHJP = (FDX, SMK)\r\nRBM = (HHB, LTN)\r\nCRM = (RBD, LBM)\r\nDBR = (CST, SNC)\r\nNQR = (CTR, TFG)\r\nGQS = (GVR, CFJ)\r\nJSK = (FVF, VLM)\r\nKHR = (DHM, GXN)\r\nQST = (VCJ, LNT)\r\nDQH = (NCV, LQR)\r\nPCQ = (JRP, RBM)\r\nMMH = (CFG, GRS)\r\nFHP = (CSS, NNH)\r\nBGB = (JVX, MVN)\r\nRCK = (XPS, XNQ)\r\nXGR = (NCH, GLV)\r\nGCD = (CMX, GJH)\r\nHJF = (NBF, TQF)\r\nDRC = (LFP, FFR)\r\nRGL = (BJR, DKP)\r\nRSM = (LDX, HQB)\r\nBTC = (BQT, MNC)\r\nSRV = (SBL, SKV)\r\nNFG = (JVT, SSC)\r\nCGX = (BVK, XLG)\r\nQFH = (KDR, LGT)\r\nVCT = (JJF, DGK)\r\nLBM = (PKL, SGH)\r\nMKS = (QGF, JRV)\r\nQSG = (LTK, MPV)\r\nGGT = (BGG, XHP)\r\nGVR = (VRD, CQJ)\r\nGPD = (HQX, HPP)\r\nLLD = (KDK, XVJ)\r\nDCG = (LRN, XSS)\r\nDSJ = (DFG, FMM)\r\nXMD = (DKP, BJR)\r\nMNK = (LRN, XSS)\r\nFTT = (SVN, SCG)\r\nCMX = (SRN, XSC)\r\nXVP = (BVP, JBL)\r\nBQP = (DCG, MNK)\r\nRTM = (KHF, QPJ)\r\nFFR = (KPV, XTP)\r\nVLN = (PJQ, KTF)\r\nJQX = (TNJ, DJG)\r\nKTF = (PDG, KDF)\r\nJVH = (LNC, PXL)\r\nBPH = (NJC, DQG)\r\nMFJ = (XHD, VFF)\r\nCDC = (DLK, KMF)\r\nMXN = (LSV, FCM)\r\nLGT = (MPB, PNG)\r\nXFT = (RCT, PPF)\r\nBSJ = (DBK, LTT)\r\nBVT = (JSP, QVG)\r\nQBC = (XVJ, KDK)\r\nVRD = (LFG, FHF)\r\nKQT = (GVP, VGJ)\r\nCSS = (NKM, KGQ)\r\nHXL = (DTH, NCL)\r\nFXJ = (DRB, JPR)\r\nFFT = (JVT, SSC)\r\nNJH = (NQK, BJM)\r\nGHS = (CLL, NJH)\r\nMMQ = (JQX, CSX)\r\nPGD = (FKF, RGS)\r\nPJQ = (KDF, PDG)\r\nLFG = (KSB, CMM)\r\nLRN = (BVF, KSQ)\r\nGGX = (JSS, MTS)\r\nLCC = (TDX, DLC)\r\nHPP = (LTX, GHS)\r\nCLL = (BJM, NQK)\r\nTPQ = (XTC, TGP)\r\nBQQ = (CHV, VVM)\r\nPVJ = (LNT, VCJ)\r\nQNQ = (QTV, CMH)\r\nCVD = (XGF, NBH)\r\nJVT = (MRN, JTG)\r\nVFQ = (BXS, FCG)\r\nCPM = (NTV, RSG)\r\nQNF = (DLK, KMF)\r\nGCA = (MGL, NNM)\r\nMGX = (TFX, XNN)\r\nMHR = (NJX, DNT)\r\nKTM = (GDK, MQS)\r\nKDR = (MPB, PNG)\r\nNDF = (XXP, CJB)\r\nZZZ = (SKQ, JKJ)\r\nMQL = (FBK, GRT)\r\nNHV = (CKQ, XFD)\r\nNBH = (PMR, LPL)\r\nKCL = (FFB, TPF)\r\nBJR = (FTB, KXR)\r\nXSM = (QCL, MTK)\r\nKBG = (QSG, LMK)\r\nSKC = (NBQ, DKC)\r\nPNG = (CNM, LQK)\r\nHTB = (RMH, SNF)\r\nRDM = (NJX, DNT)\r\nFRM = (BXN, XBH)\r\nXTC = (MNR, XCK)\r\nJVX = (NLN, CCC)\r\nGVQ = (CDM, HPX)\r\nSCG = (JJD, DBR)\r\nCCC = (CMR, NKL)\r\nSNC = (KVK, QTC)\r\nGJF = (BHB, GGT)\r\nBJK = (JPS, BKQ)\r\nPCC = (LRQ, MKS)\r\nRBV = (PVJ, QST)\r\nKMF = (BQQ, BXG)\r\nKSQ = (HNT, CPM)\r\nLPN = (CJB, XXP)\r\nDLK = (BXG, BQQ)\r\nMPB = (CNM, LQK)\r\nVSH = (MVJ, GXS)\r\nQBQ = (NBF, TQF)\r\nXLG = (LNF, KCF)\r\nLRQ = (QGF, JRV)\r\nPVQ = (SGF, BBC)\r\nDSS = (MJT, QML)\r\nTLQ = (FRP, LDV)\r\nDHC = (XFC, DSS)\r\nFRD = (PNF, SFZ)\r\nHGH = (STV, VDL)\r\nFHL = (FNC, TJJ)\r\nDHQ = (XGR, NMN)\r\nBRJ = (BHR, GBT)\r\nCQJ = (FHF, LFG)\r\nKDK = (TTX, VLH)\r\nQJP = (NQR, RJL)\r\nGCM = (RXH, KHR)\r\nTFM = (GGR, BVT)\r\nNKL = (JHH, CKL)\r\nPFQ = (LMK, QSG)\r\nXXP = (RBV, QRP)\r\nPJM = (TBP, HTB)\r\nLDG = (GVQ, SMN)\r\nGNS = (VVF, MFX)\r\nTTH = (MRX, KNT)\r\nJXL = (QJD, HKK)\r\nQKG = (XHK, RNK)\r\nRXD = (SRV, CXH)\r\nSBS = (CTL, BGB)\r\nCSC = (JFC, XSH)\r\nSKQ = (RNQ, QVN)\r\nQSS = (QCS, QFP)\r\nJJF = (QQX, QQX)\r\nKMB = (LFP, FFR)\r\nLMD = (RXD, NDN)\r\nSSQ = (HMP, BGK)\r\nGKL = (PGQ, NHK)\r\nDMH = (KKJ, MTX)\r\nRBD = (SGH, PKL)\r\nJBG = (RLB, RRL)\r\nXPR = (PHH, MXL)\r\nPCH = (TJF, RCH)\r\nSRN = (BJK, LLT)\r\nRGV = (NFQ, HMC)\r\nMPV = (NFM, CJK)\r\nRLB = (JDH, TMT)\r\nXQK = (CSJ, FRT)\r\nTTX = (VJP, NCG)\r\nGPB = (KNT, MRX)\r\nXKH = (GPB, TTH)\r\nXJP = (FBK, GRT)\r\nSTF = (XKH, QHQ)\r\nLCN = (JKJ, SKQ)\r\nSBL = (MNV, QFH)\r\nBQT = (QBB, NMX)\r\nDBS = (CMC, KFX)\r\nBVR = (BSJ, NBP)\r\nSTV = (XFX, QGQ)\r\nCDM = (QFQ, MBF)\r\nNRK = (RRL, RLB)\r\nQDT = (MQN, CGX)\r\nJBL = (BMR, JVJ)\r\nDBK = (HHV, KTD)\r\nJNM = (JVL, KPM)\r\nMPK = (QXQ, RHK)\r\nNRT = (NSH, GRC)\r\nCMH = (HFN, FXJ)\r\nKFV = (HHT, JSK)\r\nXCZ = (GSR, CNK)\r\nGSR = (QQK, DHQ)\r\nPPF = (QKJ, DRK)\r\nBGQ = (KRM, SVX)\r\nQGF = (QBQ, HJF)\r\nSFZ = (NNM, MGL)\r\nXHD = (NFD, PSS)\r\nFTB = (TFM, CXQ)\r\nXSS = (KSQ, BVF)\r\nSGH = (XVG, PVQ)\r\nNKC = (GRC, NSH)\r\nRBP = (PQP, CMP)\r\nBRR = (JGB, GVH)\r\nPDT = (RLP, DXM)\r\nGLV = (JTN, FVN)\r\nXKJ = (KPM, JVL)\r\nMQN = (XLG, BVK)\r\nMRN = (LVR, MPK)\r\nLNF = (HCT, DBS)\r\nTLT = (MCP, JBC)\r\nQVG = (NKC, NRT)\r\nVGJ = (KJF, SBS)\r\nPDB = (GVP, VGJ)\r\nFRT = (FHJ, GQS)\r\nGXN = (XVL, PPZ)\r\nQHQ = (GPB, TTH)\r\nDQR = (RFF, MFM)\r\nTTQ = (JNC, BKP)\r\nJTK = (CCQ, MBJ)\r\nSLC = (QDG, BSP)\r\nTDT = (TSP, SKL)\r\nVGQ = (CKR, KPF)\r\nTJJ = (PGD, RNC)\r\nCXQ = (GGR, BVT)\r\nFNC = (PGD, RNC)\r\nJFQ = (DTG, GJL)\r\nNPM = (GGT, BHB)\r\nFQD = (MCD, DSJ)\r\nTQF = (QGS, VVK)\r\nSVX = (TLC, DDL)\r\nTDX = (BVV, NGL)\r\nMSV = (NCL, DTH)\r\nGQQ = (BVB, LGS)\r\nLNC = (PCQ, RVK)\r\nBSP = (NSB, CSF)\r\nMNR = (XTX, TRT)\r\nPDQ = (GJM, TDL)\r\nMBF = (CFT, STF)\r\nQJD = (RQP, VGD)\r\nCNM = (BPQ, CGG)\r\nXLS = (GSS, GPD)\r\nTFX = (NPM, GJF)\r\nDLC = (BVV, NGL)\r\nBVK = (LNF, KCF)\r\nVGD = (DFF, XPK)\r\nRGS = (LPN, NDF)\r\nJRP = (HHB, LTN)\r\nGDD = (VST, SVR)\r\nBDN = (RPD, QQF)\r\nXTX = (VMH, KKV)\r\nNMN = (NCH, GLV)\r\nCMC = (VGF, HLG)\r\nNBF = (VVK, QGS)\r\nLCV = (TFX, XNN)\r\nBBC = (CTP, KKQ)\r\nTHR = (DRC, KMB)\r\nGNT = (MTX, KKJ)\r\nDVQ = (RTM, VDX)\r\nNFQ = (VVX, VCD)\r\nCKQ = (HMV, XPR)\r\nFCG = (VGQ, LDR)\r\nKRM = (TLC, DDL)\r\nLTX = (NJH, CLL)\r\nVDQ = (JKS, GNS)\r\nXSC = (LLT, BJK)\r\nHQB = (GBP, RFP)\r\nVDX = (KHF, QPJ)\r\nRPC = (VFR, MFJ)\r\nQTC = (FFT, NFG)\r\nHLM = (BSP, QDG)\r\nGGR = (QVG, JSP)\r\nXCK = (XTX, TRT)\r\nQFP = (KVD, XPB)\r\nLMV = (CSJ, FRT)\r\nSKL = (HXL, MSV)\r\nTVP = (DJH, BKC)\r\nQML = (QKH, SMT)\r\nMNV = (KDR, LGT)\r\nHRC = (SBG, JVH)\r\nBJM = (KXG, DQR)\r\nTND = (DTG, GJL)\r\nJJN = (FQD, CRH)\r\nLSV = (NRK, JBG)\r\nGBT = (CLK, XVF)\r\nBGK = (QRN, BDN)\r\nBLV = (LJC, VLN)\r\nKXR = (CXQ, TFM)\r\nCMR = (JHH, CKL)\r\nXFQ = (MQL, XJP)\r\nMTX = (RPC, RRK)\r\nNJC = (GQQ, CQK)\r\nFVB = (FNC, TJJ)\r\nFBX = (KXJ, TGM)\r\nGPP = (XDC, CSC)\r\nNRB = (JRQ, TLQ)\r\nRRK = (VFR, MFJ)\r\nTKS = (JJN, DMB)\r\nGJH = (XSC, SRN)\r\nCFJ = (CQJ, VRD)\r\nMFX = (LCV, MGX)\r\nXTR = (QFP, QCS)\r\nQGQ = (DKT, XSM)\r\nCFZ = (GRJ, KPD)\r\nJGB = (HRC, LRR)\r\nRDJ = (DKC, NBQ)\r\nGRS = (XQG, DPN)\r\nJPS = (XKJ, JNM)\r\nJSS = (LJJ, TDT)\r\nQPJ = (RDM, MHR)\r\nDCN = (SMN, GVQ)\r\nPKL = (XVG, PVQ)\r\nSXA = (HCB, QKG)\r\nLTN = (HJP, HMK)\r\nLVR = (QXQ, RHK)\r\nHFN = (JPR, DRB)\r\nJDH = (HKC, GGX)\r\nMRX = (SHB, JDB)\r\nLFP = (KPV, XTP)\r\nDKP = (KXR, FTB)\r\nXPG = (QNF, CDC)\r\nMRH = (LDX, HQB)\r\nXFX = (DKT, DKT)\r\nKKX = (HDB, DQH)\r\nSVR = (KFP, FTT)\r\nVCJ = (QMN, BVR)\r\nLQH = (MKL, LCC)\r\nMJT = (QKH, SMT)\r\nQRP = (QST, PVJ)\r\nTMP = (MCP, JBC)\r\nHLG = (PFS, VVQ)\r\nLLV = (CMH, QTV)\r\nQBB = (BLM, FTM)\r\nCTV = (HTM, XFT)\r\nDNT = (KFG, BRR)\r\nXHK = (BRJ, QCB)\r\nCJK = (CTD, CVD)\r\nAAA = (JKJ, SKQ)\r\nBXX = (GNT, DMH)\r\nHCB = (RNK, XHK)\r\nLNT = (QMN, BVR)\r\nTGM = (NXP, JHN)\r\nCQK = (LGS, BVB)\r\nCJB = (RBV, QRP)\r\nHDB = (NCV, LQR)\r\nCNQ = (CTV, MQB)\r\nBHN = (GDK, GDK)\r\nDML = (JJF, DGK)\r\nFVF = (KRH, BMQ)\r\nTSP = (MSV, HXL)\r\nQBG = (VLR, QJP)\r\nKNT = (JDB, SHB)\r\nFCS = (TGM, KXJ)\r\nFVN = (JFQ, TND)\r\nDHV = (FCG, BXS)\r\nXPK = (VHV, THR)\r\nBKP = (VDQ, HPT)\r\nVST = (FTT, KFP)\r\nDLS = (VVL, SXD)\r\nFTR = (MBJ, CCQ)\r\nMXL = (CRM, VQB)\r\nDHP = (DHC, PQQ)\r\nBXS = (LDR, VGQ)\r\nDQL = (HDB, DQH)\r\nTMT = (GGX, HKC)\r\nPFC = (CJF, CFZ)\r\nCTD = (XGF, NBH)\r\nVFR = (VFF, XHD)\r\nRQP = (DFF, XPK)\r\nLTK = (NFM, CJK)\r\nMTS = (LJJ, TDT)\r\nHHT = (FVF, VLM)\r\nMNC = (QBB, NMX)\r\nFKF = (LPN, NDF)\r\nLHD = (QJD, HKK)\r\nJFC = (MJV, MJV)\r\nXXX = (LMD, LGH)\r\nNCV = (HFF, FHP)\r\nPSS = (BQP, NJF)\r\nNQH = (XLS, FQG)\r\nVGF = (VVQ, PFS)\r\nSKV = (MNV, QFH)\r\nLJC = (KTF, PJQ)\r\nSNX = (XDC, CSC)\r\nNDN = (CXH, SRV)\r\nHKC = (MTS, JSS)\r\nPHH = (CRM, VQB)\r\nFLN = (GJM, TDL)\r\nVVK = (PHD, GKL)\r\nMQS = (RKN, PFC)\r\nLRR = (JVH, SBG)\r\nJKJ = (RNQ, QVN)\r\nXVL = (HCB, QKG)\r\nNPD = (SNX, GPP)\r\nKTD = (QDJ, KHK)\r\nTDL = (RGV, GLB)\r\nSNF = (HLJ, XXX)\r\nMBJ = (JMK, BDB)\r\nGDK = (RKN, RKN)\r\nSFV = (DLS, PLR)\r\nKNF = (BGK, HMP)\r\nXVF = (QXB, BGQ)\r\nRMH = (HLJ, XXX)\r\nLPF = (XVP, NHB)\r\nNSH = (KQJ, MBT)\r\nQNM = (GXV, FRM)\r\nLTM = (BKL, SKR)\r\nGJL = (TCX, LVM)\r\nKXG = (RFF, MFM)\r\nTFG = (DHV, VFQ)\r\nHPX = (MBF, QFQ)\r\nGJM = (GLB, RGV)\r\nVCD = (TVH, GCM)\r\nNLN = (NKL, CMR)\r\nXPB = (TVP, QRT)\r\nFRJ = (XTC, TGP)\r\nFHF = (KSB, CMM)\r\nKVK = (FFT, NFG)\r\nGRC = (MBT, KQJ)\r\nBHR = (XVF, CLK)\r\nHLJ = (LMD, LGH)\r\nLLT = (JPS, BKQ)\r\nDKC = (BPL, HGH)\r\nBPL = (STV, VDL)\r\nSHB = (FBX, FCS)\r\nFQG = (GPD, GSS)\r\nTLN = (RCQ, RBP)\r\nLDR = (CKR, KPF)\r\nNCH = (JTN, FVN)\r\nCMM = (BPH, MXS)\r\nRLP = (LPF, LSS)\r\nCKR = (SHL, NQH)\r\nTJF = (FDT, CCB)\r\nBVD = (DLS, PLR)\r\nQQK = (XGR, NMN)\r\nKPV = (QBC, LLD)\r\nHFF = (NNH, CSS)\r\nDKG = (PQQ, DHC)\r\nTQZ = (DMB, JJN)\r\nMLC = (VNN, XPG)\r\nDHX = (PDB, KQT)\r\nBHB = (XHP, BGG)\r\nRHK = (QDT, JLV)\r\nPDG = (PJM, TDD)\r\nFHJ = (CFJ, GVR)\r\nDJG = (KSD, DHX)\r\nRFF = (MXN, PMM)\r\nMQB = (HTM, XFT)\r\nNSB = (BTC, MLD)\r\nDDL = (FRJ, TPQ)\r\nXDB = (VDX, RTM)\r\nNJX = (KFG, BRR)\r\nJHH = (MVX, MCB)\r\nDFF = (THR, VHV)\r\nGMA = (JJN, DMB)\r\nSHP = (BKL, SKR)\r\nQXB = (KRM, SVX)";
	const string _testSet2 = "LLR\r\n\r\nAAA = (BBB, BBB)\r\nBBB = (AAA, ZZZ)\r\nZZZ = (ZZZ, ZZZ)";
	const string _testSetP2 = "LR\r\n\r\n11A = (11B, XXX)\r\n11B = (XXX, 11Z)\r\n11Z = (11B, XXX)\r\n22A = (22B, XXX)\r\n22B = (22C, 22C)\r\n22C = (22Z, 22Z)\r\n22Z = (22B, 22B)\r\nXXX = (XXX, XXX)";

	public DayEight() {
		Console.WriteLine("\n*** Day Eight ***\n");
		Console.WriteLine("Number of step in path: " + PartOne(_dataSet));
		Console.WriteLine("Number of steps in quantic paths when all to Z: " + PartTwo(_dataSet));
	}

	private static long PartOne(string data) {
		string[] parts = data.Split("\r\n\r\n");
		return SolveFor("AAA", parts[0], MapNodes(parts[1]));
	}

	private static long SolveFor(string start, string path, Dictionary<string, (string, string)> nodes) {
		long count = 0;
		string location = start;

		while (!location.Contains('Z')) {
			location = path[(int) count % path.Length] == 'R' ? nodes[location].Item2 : nodes[location].Item1;
			count++;
		}

		return count;
	}

	private static Dictionary<string, (string, string)> MapNodes(string nodes) {
		Dictionary<string, (string, string)> res = [];

		foreach(string line in nodes.Split("\r\n")) {
			MatchCollection matches = Regex.Matches(line, "[A-Z0-9]{3}");
			res.Add(matches[0].Value, (matches[1].Value, matches[2].Value));
		}

		return res;
	}

	private long PartTwo(string data) {
		string[] parts = data.Split("\r\n\r\n");
		List<long> paths = GetStartingPoints(parts[1]).Select(loc => SolveFor(loc, parts[0], MapNodes(parts[1]))).ToList();

		return paths.Aggregate(paths[0], LCM);
	}


	private List<string> GetStartingPoints(string data) {
		string[] lines = data.Split("\r\n");
		List<string> res = [];

		foreach(string line in lines) {
			string[] parts = line.Split("=");
			if (parts[0].Contains('A')) {
				res.Add(parts[0].Trim());
			}
		}

		return res;
	}

	private static long GCD(long a, long b) {
		return b == 0 ? a : GCD(b, a % b);
	}

	private static long LCM(long a, long b) {
		return Math.Abs(a * b) / GCD(a, b);
	}
}
